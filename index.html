<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>สมัครติวฟรี! อังกฤษพิชิต TCAS ทุกสนามสอบ กับ The Act.</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(to right, #FEE3BC, #C8F0E5); /* Light orange to light green gradient */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .form-container {
            background-color: #ffffff;
            border-radius: 2rem; /* More rounded corners */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            padding: 2.5rem;
            max-width: 800px; /* Wider form */
            width: 100%;
            border: 1px solid #e0e0e0;
        }
        .form-header {
            background: linear-gradient(to right, #FF7E5F, #FEB47B); /* Orange gradient for header */
            border-radius: 1.5rem 1.5rem 0 0;
            padding: 2rem;
            color: white;
            text-align: center;
            margin: -2.5rem -2.5rem 2rem -2.5rem; /* Extend header to edges */
            position: relative;
            z-index: 1;
        }
        .form-header h1 {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            margin-bottom: 0.5rem;
        }
        .form-header p {
            font-size: 1.125rem; /* text-lg */
        }
        .input-group {
            margin-bottom: 1.5rem;
        }
        .input-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600; /* font-semibold */
            color: #333;
            display: flex;
            align-items: center;
        }
        .input-label i {
            margin-right: 8px;
            color: #4CAF50; /* Green icon */
        }
        .text-input, .select-input, .textarea-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #E5E7EB;
            border-radius: 0.75rem; /* rounded-xl */
            font-size: 1rem;
            color: #333;
            transition: all 0.2s ease-in-out;
            background-color: #F9FAFB; /* Light gray background */
        }
        .text-input:focus, .select-input:focus, .textarea-input:focus {
            border-color: #4CAF50; /* Green focus border */
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2); /* Green focus shadow */
            outline: none;
            background-color: #ffffff;
        }
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1.5rem;
        }
        .checkbox-group input[type="checkbox"] {
            margin-top: 0.25rem;
            margin-right: 0.75rem;
            accent-color: #4CAF50; /* Green checkbox */
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 0.25rem;
        }
        .checkbox-group label {
            font-size: 0.95rem;
            color: #555;
            line-height: 1.5;
        }
        .checkbox-group a {
            color: #FF7E5F; /* Orange link */
            text-decoration: none;
            font-weight: 500;
        }
        .checkbox-group a:hover {
            text-decoration: underline;
        }
        .radio-group label, .checkbox-options label {
            display: flex;
            align-items: center;
            margin-bottom: 0.75rem;
            cursor: pointer;
            color: #333;
        }
        .radio-group input[type="radio"], .checkbox-options input[type="checkbox"] {
            margin-right: 0.75rem;
            accent-color: #FF7E5F; /* Orange for radio/checkbox */
            width: 1.15rem;
            height: 1.15rem;
        }
        .submit-button {
            width: 100%;
            padding: 1rem 1.5rem;
            background: linear-gradient(to right, #4CAF50, #8BC34A); /* Green gradient button */
            color: white;
            border: none;
            border-radius: 0.75rem; /* rounded-xl */
            font-size: 1.25rem; /* text-xl */
            font-weight: 700; /* font-bold */
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }
        .submit-button:hover {
            background: linear-gradient(to right, #8BC34A, #4CAF50);
            box-shadow: 0 8px 20px rgba(76, 175, 80, 0.4);
            transform: translateY(-2px);
        }
        .thank-you-message {
            text-align: center;
            font-size: 1.25rem;
            color: #333;
            margin-top: 1.5rem;
            display: none; /* Hidden by default */
            padding: 1.5rem;
            background-color: #E8F5E9; /* Light green background */
            border-radius: 1rem;
            border: 1px solid #A5D6A7;
        }
        .logo-image {
            max-width: 250px; /* Adjust size as needed */
            height: auto;
            margin: 0 auto 1rem auto;
            display: block;
        }
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .form-container {
                padding: 1.5rem;
            }
            .form-header {
                padding: 1.5rem;
                margin: -1.5rem -1.5rem 1.5rem -1.5rem;
            }
            .form-header h1 {
                font-size: 1.75rem;
            }
            .form-header p {
                font-size: 1rem;
            }
            .submit-button {
                font-size: 1.1rem;
                padding: 0.8rem 1rem;
            }
        }
        .error-message-box {
            background-color: #ffebee; /* Light red background */
            color: #c62828; /* Dark red text */
            border: 1px solid #ef9a9a; /* Red border */
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
            font-weight: 500;
            text-align: center;
            display: none; /* Hidden by default */
        }
    </style>
</head>
<body>
    <div class="form-container">
        <div class="form-header">
            <h1>สมัครติวฟรี! อังกฤษพิชิต TCAS ทุกสนามสอบ กับ The Act.</h1>
            <p>เลือกรอบเรียนที่คุณสะดวก พร้อมรับสิทธิประโยชน์พิเศษมากมาย</p>
        </div>

        <!-- Error message box -->
        <div id="urlError" class="error-message-box">
            <i class="fas fa-exclamation-triangle mr-2"></i> กรุณาเปลี่ยน 'YOUR_GOOGLE_SHEET_WEB_APP_URL' เป็น URL จริงของ Google Apps Script Web App ของคุณ
        </div>

        <form id="registrationForm" action="https://script.google.com/macros/s/AKfycbzXCy_5rN6CoaGV9Pz_m7zwLS4JmaOOZwWJw5V4Yyl8KEBE_KpIX-HJlSZdAzTTKpAE/exec" method="POST">
            <!-- Privacy Policy Checkbox -->
            <div class="checkbox-group">
                <input type="checkbox" id="privacyConsent" name="privacyConsent" required>
                <label for="privacyConsent">
                    ข้าพเจ้าได้ทำความเข้าใจรายละเอียดค่าย และมีความประสงค์จะกรอกข้อมูลเพื่อสมัครติวครั้งนี้
                    และได้อ่าน <a href="https://www.theactkk.net/%E0%B8%99%E0%B9%82%E0%B8%A2%E0%B8%B2%E0%B8%A2%E0%B8%84%E0%B8%A7%E0%B8%B2%E0%B8%A1%E0%B9%80%E0%B8%9B%E0%B9%87%E0%B8%99%E0%B8%AA%E0%B9%88%E0%B8%A7%E0%B8%99%E0%B8%95%E0%B8%B1%E0%B8%A7" target="_blank" rel="noopener noreferrer">นโยบายความเป็นส่วนตัว</a> แล้ว
                </label>
            </div>

            <!-- Title -->
            <div class="input-group">
                <label for="title" class="input-label"><i class="fas fa-user-circle"></i> คำนำหน้า</label>
                <select id="title" name="title" class="select-input" required>
                    <option value="">-- เลือกคำนำหน้า --</option>
                    <option value="เด็กชาย">เด็กชาย</option>
                    <option value="เด็กหญิง">เด็กหญิง</option>
                    <option value="นาย">นาย</option>
                    <option value="นางสาว">นางสาว</option>
                </select>
            </div>

            <!-- Full Name -->
            <div class="input-group">
                <label for="fullName" class="input-label"><i class="fas fa-user-edit"></i> ชื่อ - นามสกุล</label>
                <input type="text" id="fullName" name="fullName" class="text-input" placeholder="กรุณากรอกชื่อ-นามสกุล" required>
            </div>

            <!-- Nickname -->
            <div class="input-group">
                <label for="nickname" class="input-label"><i class="fas fa-smile"></i> ชื่อเล่น</label>
                <input type="text" id="nickname" name="nickname" class="text-input" placeholder="กรุณากรอกชื่อเล่น" required>
            </div>

            <!-- Grade Level -->
            <div class="input-group">
                <label for="grade" class="input-label"><i class="fas fa-graduation-cap"></i> ระดับชั้น</label>
                <select id="grade" name="grade" class="select-input" required>
                    <option value="">-- เลือกระดับชั้น --</option>
                    <option value="ม.1">ม.1</option>
                    <option value="ม.2">ม.2</option>
                    <option value="ม.3">ม.3</option>
                    <option value="ม.4">ม.4</option>
                    <option value="ม.5">ม.5</option>
                    <option value="ม.6">ม.6</option>
                </select>
            </div>

            <!-- School -->
            <div class="input-group">
                <label for="school" class="input-label"><i class="fas fa-school"></i> โรงเรียน</label>
                <input type="text" id="school" name="school" class="text-input" placeholder="กรุณากรอกชื่อโรงเรียน" required>
            </div>

            <!-- School Province -->
            <div class="input-group">
                <label for="schoolProvince" class="input-label"><i class="fas fa-map-marker-alt"></i> จังหวัดที่ตั้งโรงเรียน</label>
                <input type="text" id="schoolProvince" name="schoolProvince" class="text-input" placeholder="กรุณากรอกจังหวัดที่ตั้งโรงเรียน" required>
            </div>

            <!-- Applicant Phone -->
            <div class="input-group">
                <label for="applicantPhone" class="input-label"><i class="fas fa-phone"></i> เบอร์ติดต่อผู้สมัคร</label>
                <input type="tel" id="applicantPhone" name="applicantPhone" class="text-input" pattern="[0-9]{10}" placeholder="08XXXXXXXX" required>
                <small class="text-gray-500 text-sm mt-1 block">ตัวอย่าง: 0812345678 (10 หลัก)</small>
            </div>

            <!-- Parent Phone -->
            <div class="input-group">
                <label for="parentPhone" class="input-label"><i class="fas fa-phone-alt"></i> เบอร์ติดต่อผู้ปกครอง</label>
                <input type="tel" id="parentPhone" name="parentPhone" class="text-input" pattern="[0-9]{10}" placeholder="08XXXXXXXX" required>
                <small class="text-gray-500 text-sm mt-1 block">ตัวอย่าง: 0812345678 (10 หลัก)</small>
            </div>

            <!-- Applicant Email -->
            <div class="input-group">
                <label for="applicantEmail" class="input-label"><i class="fas fa-envelope"></i> อีเมลผู้สมัครเพื่อรับไฟล์เอกสารติว</label>
                <input type="email" id="applicantEmail" name="applicantEmail" class="text-input" placeholder="แนะนำเป็น Gmail เท่านั้น" required>
            </div>

            <!-- LINE ID -->
            <div class="input-group">
                <label for="lineId" class="input-label"><i class="fab fa-line"></i> LINE ID ผู้สมัคร</label>
                <input type="text" id="lineId" name="lineId" class="text-input" placeholder="กรุณากรอก LINE ID" required>
            </div>

            <!-- Desired Faculty/Major -->
            <div class="input-group">
                <label for="desiredFaculty" class="input-label"><i class="fas fa-user-graduate"></i> คณะ/สาขาที่อยากเข้าเรียน</label>
                <select id="desiredFaculty" name="desiredFaculty" class="select-input" required>
                    <option value="">-- เลือกคณะ/สาขา --</option>
                    <option value="คณะแพทยศาสตร์">คณะแพทยศาสตร์</option>
                    <option value="คณะทันตแพทยศาสตร์">คณะทันตแพทยศาสตร์</option>
                    <option value="คณะเภสัชศาสตร์">คณะเภสัชศาสตร์</option>
                    <option value="คณะสัตวแพทยศาสตร์">คณะสัตวแพทยศาสตร์</option>
                    <option value="คณะเทคนิคการแพทย์">คณะเทคนิคการแพทย์</option>
                    <option value="คณะพยาบาลศาสตร์">คณะพยาบาลศาสตร์</option>
                    <option value="คณะสาธารณสุขศาสตร์">คณะสาธารณสุขศาสตร์</option>
                    <option value="คณะวิทยาศาสตร์">คณะวิทยาศาสตร์</option>
                    <option value="คณะวิศวกรรมศาสตร์">คณะวิศวกรรมศาสตร์</option>
                    <option value="คณะเกษตรศาสตร์">คณะเกษตรศาสตร์</option>
                    <option value="คณะเทคโนโลยี">คณะเทคโนโลยี</option>
                    <option value="คณะสถาปัตยกรรมศาสตร์">คณะสถาปัตยกรรมศาสตร์</option>
                    <option value="คณะศึกษาศาสตร์">คณะศึกษาศาสตร์</option>
                    <option value="คณะมนุษยศาสตร์และสังคมศาสตร์">คณะมนุษยศาสตร์และสังคมศาสตร์</option>
                    <option value="คณะนิติศาสตร์">คณะนิติศาสตร์</option>
                    <option value="คณะบริหารธุรกิจและการบัญชี">คณะบริหารธุรกิจและการบัญชี</option>
                    <option value="คณะเศรษฐศาสตร์">คณะเศรษฐศาสตร์</option>
                    <option value="คณะศิลปกรรมศาสตร์">คณะศิลปกรรมศาสตร์</option>
                    <option value="คณะวิทยาการสารสนเทศ">คณะวิทยาการสารสนเทศ</option>
                    <option value="คณะวิทยาการจัดการ">คณะวิทยาการจัดการ</option>
                    <option value="วิทยาลัยการปกครองท้องถิ่น">วิทยาลัยการปกครองท้องถิ่น</option>
                    <option value="วิทยาลัยนานาชาติ">วิทยาลัยนานาชาติ</option>
                    <option value="วิทยาลัยการคอมพิวเตอร์">วิทยาลัยการคอมพิวเตอร์</option>
                    <option value="คณะสหวิทยาการ (วิทยาเขตหนองคาย)">คณะสหวิทยาการ (วิทยาเขตหนองคาย)</option>
                </select>
            </div>

            <!-- Preferred Class Session -->
            <div class="input-group">
                <label class="input-label"><i class="fas fa-calendar-alt"></i> เลือกรอบที่ต้องการสมัครติว</label>
                <div class="radio-group">
                    <label>
                        <input type="radio" name="classSession" value="19 มิ.ย. 68 เวลา 18.30 - 21.30 น." required>
                        19 มิ.ย. 68 เวลา 18.30 - 21.30 น.
                    </label>
                    <label>
                        <input type="radio" name="classSession" value="26 มิ.ย. 68 เวลา 18.30 - 21.30 น.">
                        26 มิ.ย. 68 เวลา 18.30 - 21.30 น.
                    </label>
                </div>
            </div>

            <!-- Preferred Contact Time -->
            <div class="input-group">
                <label for="contactTime" class="input-label"><i class="fas fa-clock"></i> ช่วงเวลาที่สะดวกให้ติดต่อกลับ</label>
                <select id="contactTime" name="contactTime" class="select-input" required>
                    <option value="">-- เลือกช่วงเวลา --</option>
                    <option value="9.00 น.">9.00 น.</option>
                    <option value="10.00 น.">10.00 น.</option>
                    <option value="11.00 น.">11.00 น.</option>
                    <option value="12.00 น.">12.00 น.</option>
                    <option value="13.00 น.">13.00 น.</option>
                    <option value="14.00 น.">14.00 น.</option>
                    <option value="15.00 น.">15.00 น.</option>
                    <option value="16.00 น.">16.00 น.</option>
                    <option value="17.00 น.">17.00 น.</option>
                    <option value="18.00 น.">18.00 น.</option>
                    <option value="19.00 น.">19.00 น.</option>
                </select>
            </div>

            <!-- Expectations -->
            <div class="input-group">
                <label class="input-label"><i class="fas fa-lightbulb"></i> ความคาดหวังในการติวกับ The Act ในครั้งนี้</label>
                <textarea id="expectations" name="expectations" class="textarea-input" rows="4" placeholder="กรุณาอธิบายความคาดหวังของคุณในการติวครั้งนี้"></textarea>
            </div>

            <!-- How did you know The Act? -->
            <div class="input-group">
                <label class="input-label"><i class="fas fa-question-circle"></i> คุณรู้จักค่ายติว The Act ผ่านช่องทางใดบ้าง? (เลือกได้หลายข้อ)</label>
                <div class="checkbox-options grid grid-cols-1 sm:grid-cols-2 gap-2">
                    <label><input type="checkbox" name="source" value="Facebook"> Facebook</label>
                    <label><input type="checkbox" name="source" value="TikTok"> TikTok</label>
                    <label><input type="checkbox" name="source" value="Line OA"> Line OA</label>
                    <label><input type="checkbox" name="source" value="เพื่อนแนะนำ"> เพื่อนแนะนำ</label>
                    <label><input type="checkbox" name="source" value="ครูแนะนำ"> ครูแนะนำ</label>
                    <label><input type="checkbox" name="source" value="โฆษณาออนไลน์"> โฆษณาออนไลน์</label>
                    <label><input type="checkbox" name="source" value="เว็บไซต์ The Act"> เว็บไซต์ The Act</label>
                    <label><input type="checkbox" name="source" value="Instagram"> Instagram</label>
                    <label><input type="checkbox" name="source" value="Twitter"> Twitter</label>
                    <label><input type="checkbox" name="source" value="Youtube"> Youtube</label>
                    <label><input type="checkbox" name="source" value="ผู้ปกครองแนะนำ"> ผู้ปกครองแนะนำ</label>
                    <label><input type="checkbox" name="source" value="รุ่นพี่แนะนำ"> รุ่นพี่แนะนำ</label>
                    <label>
                        <input type="checkbox" name="source" value="Other" id="otherSourceCheckbox"> อื่น ๆ (กรุณาระบุ)
                        <input type="text" name="otherSourceText" id="otherSourceText" class="text-input ml-2 p-1 text-sm hidden" placeholder="ระบุช่องทางอื่น ๆ">
                    </label>
                </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="submit-button"><i class="fas fa-paper-plane mr-2"></i> ส่งใบสมัคร</button>
        </form>

        <!-- Thank you message (hidden by default) -->
        <div id="thankYouMessage" class="thank-you-message">
            <p><strong>ขอบคุณที่สมัครติวฟรีกับ The Act.</strong></p>
            <p>ให้บันทึกภาพผลการสมัครนี้ ส่งยืนยันการสมัครและเข้ากลุ่มไลน์ที่ไลน์ @theactkk หรือ <a href="https://line.me/R/ti/p/@zay7842v" target="_blank" class="text-blue-600 hover:underline font-semibold">คลิ๊ก</a></p>
        </div>
    </div>

    <script>
        // Get the form and thank you message elements
        const form = document.getElementById('registrationForm');
        const thankYouMessage = document.getElementById('thankYouMessage');
        const otherSourceCheckbox = document.getElementById('otherSourceCheckbox');
        const otherSourceText = document.getElementById('otherSourceText');
        const urlErrorBox = document.getElementById('urlError'); // Get the error box

        // Function to set the logo image source (no longer needed as the image is removed)
        function setLogoSource() {
            // This function is now empty as the logo is removed
        }

        // Call the function when the window loads (no longer needed)
        window.onload = setLogoSource; // This will now do nothing

        // Toggle visibility of 'Other' source text input
        otherSourceCheckbox.addEventListener('change', function() {
            if (this.checked) {
                otherSourceText.classList.remove('hidden');
                otherSourceText.setAttribute('required', 'required');
            } else {
                otherSourceText.classList.add('hidden');
                otherSourceText.removeAttribute('required');
                otherSourceText.value = ''; // Clear text if unchecked
            }
        });

        // Handle form submission
        form.addEventListener('submit', function(e) {
            e.preventDefault(); // Prevent default form submission

            // Basic validation for the privacy consent checkbox
            if (!document.getElementById('privacyConsent').checked) {
                console.error("กรุณายอมรับนโยบายความเป็นส่วนตัวก่อนส่งใบสมัคร");
                // You might want to display a custom modal here instead of just console.error
                return;
            }

            // ************************************************************************************************
            // ***** สำคัญมาก: URL ของ Google Apps Script Web App ของคุณถูกตั้งค่าไว้ที่นี่แล้ว *****
            // ***** ไม่จำเป็นต้องแก้ไขอีก หากคุณได้ Deploy Script ใน Google Sheet ถูกต้องแล้ว *****
            // ************************************************************************************************
            const googleSheetWebAppURL = "https://script.google.com/macros/s/AKfycbzXCy_5rN6CoaGV9Pz_m7zwLS4JmaOOZwWJw5V4Yyl8KEBE_KpIX-HJlSZdAzTTKpAE/exec"; 
            
            // Check if the URL is still the placeholder or invalid (should not happen if correctly updated)
            if (googleSheetWebAppURL === "YOUR_GOOGLE_SHEET_WEB_APP_URL" || !googleSheetWebAppURL.startsWith("https://script.google.com/macros/")) {
                console.error("Error: Please replace 'YOUR_GOOGLE_SHEET_WEB_APP_URL' with your actual Google Apps Script Web App URL.");
                urlErrorBox.style.display = 'block'; // Show the error message box
                return;
            } else {
                urlErrorBox.style.display = 'none'; // Hide the error message box if URL is set
            }

            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
                // Special handling for multiple checkboxes named 'source'
                if (key === 'source') {
                    if (!data[key]) {
                        data[key] = [];
                    }
                    data[key].push(value);
                } else if (key === 'otherSourceText' && otherSourceCheckbox.checked && value) {
                    // If 'Other' is checked and text is provided, add it to 'source'
                    if (!data['source']) {
                        data['source'] = [];
                    }
                    data['source'].push(value);
                } else {
                    data[key] = value;
                }
            }

            // Remove the 'Other' checkbox value from 'source' if the text field was used
            if (data['source'] && data['source'].includes('Other') && data['otherSourceText']) {
                data['source'] = data['source'].filter(item => item !== 'Other');
            }
            delete data['otherSourceText']; // Remove standalone otherSourceText as it's merged into source

            // Convert source array to a comma-separated string
            if (Array.isArray(data['source'])) {
                data['source'] = data['source'].join(', ');
            }

            // Append timestamp
            data['timestamp'] = new Date().toLocaleString();

            fetch(googleSheetWebAppURL, {
                method: 'POST',
                mode: 'no-cors', // Important for Google Apps Script
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams(data).toString()
            })
            .then(() => {
                form.reset(); // Clear the form
                form.style.display = 'none'; // Hide the form
                thankYouMessage.style.display = 'block'; // Show the thank you message
                urlErrorBox.style.display = 'none'; // Ensure error box is hidden on success
            })
            .catch(error => {
                console.error('Error submitting form:', error);
                // Display an error message to the user
                // TODO: Replace with custom modal UI for user feedback
                console.error('เกิดข้อผิดพลาดในการส่งใบสมัคร กรุณาลองใหม่อีกครั้ง');
                urlErrorBox.style.display = 'block'; // Show error box on fetch error
            });
        });
    </script>
</body>
</html>
